<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Nexus Auto Pro 2026</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" type="image/png" href="assets/logo-auto.png" />
  <link rel="stylesheet" href="styles.css?v=1" />
</head>
<body>

  <!-- ========== LOGIN ========== -->
  <div id="loginView" class="view visible">
    <div class="login-shell">

      <!-- LOGO + TÍTULO -->
      <header class="login-hero">
        <img src="assets/logo-auto.png" alt="Nexus Auto Pro 2026" class="hero-logo" />
        <div class="hero-text">
          <h1 class="hero-title">Nexus Auto Pro 2026</h1>
          <p class="hero-subtitle">
            Suite corporativa para gestión de talleres automotrices en Puerto Rico
          </p>
        </div>
      </header>

      <!-- TARJETA ÚNICA PARA ACCESO -->
      <section class="login-card-pro">
        <div class="login-card-header">
          <p class="login-tag">Acceso al panel del taller</p>
          <h2>Elige cómo quieres entrar</h2>
        </div>

        <div class="login-grid">

          <!-- ACCESO POR PIN -->
          <form id="pinForm" class="login-block">
            <h3>Acceso con PIN</h3>
            <p class="login-block-sub">
              Rápido para el personal interno del taller.
            </p>

            <label for="pinInput" class="login-label">PIN de acceso</label>
            <input
              id="pinInput"
              type="password"
              maxlength="6"
              inputmode="numeric"
              autocomplete="one-time-code"
              class="login-input"
              placeholder="••••"
              required
            />

            <button type="submit" class="btn primary btn-full">
              Entrar
            </button>

            <p class="login-footnote">
              PIN inicial por defecto: <strong>0000</strong> (cámbialo en
              <span class="link-inline">Configuración</span>).
            </p>
          </form>

          <!-- DIVISOR -->
          <div class="login-divider" aria-hidden="true">
            <span></span>
          </div>

          <!-- ACCESO POR GOOGLE -->
          <div class="login-block login-block-secondary">
            <h3>Acceso con Google</h3>
            <p class="login-block-sub">
              Multiusuario · Datos compartidos en la nube.
            </p>

            <button type="button" id="googleSignInBtn" class="btn ghost btn-full">
              Entrar con Google (taller)
            </button>

            <ul class="login-bullets">
              <li>Sincronizado en todos los dispositivos.</li>
              <li>Historial de ingresos, cotizaciones y facturas.</li>
              <li>Un solo panel para todo el equipo.</li>
            </ul>
          </div>
        </div>

        <footer class="login-footer">
          Nexus Auto Pro 2026 · Hecho para talleres que se toman en serio su operación.
        </footer>
      </section>
    </div>
  </div>

  <!-- ========== APP PRINCIPAL ========== -->
  <div id="appView" class="view">

    <!-- TOPBAR -->
    <header class="topbar">
      <div class="topbar-inner">
        <div class="brand-bar">
          <img src="assets/logo-auto.png" alt="Nexus Auto Pro 2026" class="brand-logo" />
          <div class="brand-text">
            <h1>Nexus Auto Pro 2026</h1>
            <p>Taller automotriz · Puerto Rico</p>
          </div>
        </div>

        <nav class="main-menu">
          <button class="menu-btn active" data-view="ingresosView">Panel / Ingresos</button>
          <button class="menu-btn" data-view="entregasView">Entregas</button>
          <button class="menu-btn" data-view="historialView">Historial</button>
          <button class="menu-btn" data-view="cotizacionesView">Cotizaciones</button>
          <button class="menu-btn" data-view="facturasView">Facturas</button>
          <button class="menu-btn" data-view="clientesView">Clientes</button>
          <button class="menu-btn" data-view="suplidoresView">Suplidores</button>
          <button class="menu-btn" data-view="configView">Configuración</button>
        </nav>

        <button id="logoutBtn" class="btn danger topbar-logout">Salir</button>
      </div>
    </header>

    <!-- CONTENIDO -->
    <main class="app-main">

      <!-- ========== PANEL / INGRESOS ========== -->
      <section id="ingresosView" class="screen visible">

        <div class="grid-2">
          <!-- KPIs -->
          <div class="card">
            <h2 class="card-title">Resumen de hoy</h2>
            <div class="kpi-grid">
              <div id="kpiIngresos" class="kpi-card">
                <p class="kpi-label">Ingresos abiertos</p>
                <p class="kpi-value">0</p>
                <p class="kpi-footnote">Vehículos en proceso.</p>
              </div>
              <div id="kpiMecanica" class="kpi-card">
                <p class="kpi-label">Trabajos de mecánica</p>
                <p class="kpi-value">0</p>
                <p class="kpi-footnote">Casos activos.</p>
              </div>
              <div id="kpiUltimoIngreso" class="kpi-card">
                <p class="kpi-label">Último registro</p>
                <p class="kpi-value">—</p>
                <p class="kpi-footnote">Fecha del ingreso más reciente.</p>
              </div>
            </div>
          </div>

          <!-- NUEVO INGRESO -->
          <div class="card">
            <h2 class="card-title">Nuevo ingreso</h2>
            <p class="card-subtitle">
              Captura todos los datos del cliente y del vehículo en un solo paso.
            </p>

            <form id="ingresoForm" class="form-grid">
              <div class="form-group">
                <label>Nombre del cliente</label>
                <input type="text" name="clienteNombre" required />
              </div>
              <div class="form-group">
                <label>Teléfono</label>
                <input type="text" name="clienteTelefono" />
              </div>
              <div class="form-group full">
                <label>Dirección</label>
                <input type="text" name="clienteDireccion" />
              </div>

              <div class="form-group">
                <label>Tablilla</label>
                <input type="text" name="vehiculoTablilla" />
              </div>
              <div class="form-group">
                <label>Marca</label>
                <input type="text" name="vehiculoMarca" />
              </div>
              <div class="form-group">
                <label>Modelo</label>
                <input type="text" name="vehiculoModelo" />
              </div>
              <div class="form-group">
                <label>Año</label>
                <input type="text" name="vehiculoAno" />
              </div>
              <div class="form-group">
                <label>Color</label>
                <input type="text" name="vehiculoColor" />
              </div>
              <div class="form-group full">
                <label>VIN</label>
                <input type="text" name="vehiculoVin" />
              </div>

              <div class="form-group">
                <label>Tipo de trabajo</label>
                <select name="tipoTrabajo">
                  <option value="mecanica">Mecánica</option>
                  <option value="hojalateria">Hojalatería y pintura</option>
                  <option value="pintura">Pintura</option>
                  <option value="detailing">Detailing</option>
                  <option value="otro">Otro</option>
                </select>
              </div>

              <div class="form-group full">
                <label>Descripción / diagnóstico</label>
                <textarea name="descripcionTrabajo" rows="3"></textarea>
              </div>

              <div class="form-actions full">
                <button type="submit" class="btn primary">Guardar ingreso</button>
                <span id="ingresoStatus" class="status-msg"></span>
              </div>
            </form>
          </div>
        </div>

        <!-- LISTA INGRESOS -->
        <div class="card">
          <div class="card-header-row">
            <div>
              <h2 class="card-title">Ingresos abiertos</h2>
              <p class="card-subtitle">Vehículos en proceso dentro del taller.</p>
            </div>
          </div>

          <div id="ingresosLista" class="table-wrapper">
            <!-- se llena por JS -->
          </div>
        </div>
      </section>

      <!-- ========== ENTREGAS ========== -->
      <section id="entregasView" class="screen">
        <div class="card">
          <h2 class="card-title">Entregas</h2>
          <p class="card-subtitle">
            Para registrar una entrega utiliza el botón <strong>“Registrar entrega”</strong> en la tabla de ingresos.
            Aquí solo se muestra un resumen general desde las facturas.
          </p>
          <div id="resumenFacturas" class="status-msg">
            <!-- JS actualiza -->
          </div>
        </div>
      </section>

      <!-- ========== HISTORIAL ========== -->
      <section id="historialView" class="screen">
        <div class="card">
          <h2 class="card-title">Historial por cliente / vehículo</h2>
          <p class="card-subtitle">
            Busca por nombre, tablilla o VIN. Se muestran ingresos y facturas relacionados.
          </p>

          <div class="toolbar">
            <input
              type="text"
              id="historialBuscarInput"
              placeholder="Ej. Juan Pérez, JKL123, VIN..."
            />
            <button id="historialBuscarBtn" class="btn primary">Buscar</button>
          </div>

          <div id="historialResultados" class="table-wrapper">
            <p class="placeholder">Escribe un criterio de búsqueda y presiona “Buscar”.</p>
          </div>
        </div>
      </section>

      <!-- ========== COTIZACIONES ========== -->
      <section id="cotizacionesView" class="screen">
        <div class="card">
          <div class="card-header-row">
            <div>
              <h2 class="card-title">Cotizaciones</h2>
              <p class="card-subtitle">
                Cotizaciones para seguros y trabajos automotrices.
              </p>
            </div>
            <div class="card-actions">
              <button id="nuevaCotizacionBtn" class="btn primary">Nueva cotización</button>
              <button id="exportCotizacionesBtn" class="btn ghost">Imprimir listado</button>
            </div>
          </div>

          <div id="cotizacionesTabla" class="table-wrapper">
            <!-- JS -->
          </div>
        </div>
      </section>

      <!-- ========== FACTURAS ========== -->
      <section id="facturasView" class="screen">
        <div class="card">
          <div class="card-header-row">
            <div>
              <h2 class="card-title">Facturas</h2>
              <p class="card-subtitle">
                Seguimiento de facturas pagadas y pendientes.
              </p>
            </div>
            <div class="card-actions">
              <select id="filtroEstadoFactura" class="filter-select">
                <option value="todas">Todas</option>
                <option value="pagada">Solo pagadas</option>
                <option value="pendiente">Solo pendientes</option>
              </select>
              <button id="exportFacturasBtn" class="btn ghost">Imprimir listado</button>
            </div>
          </div>

          <div id="facturasTabla" class="table-wrapper">
            <!-- JS -->
          </div>

          <div id="resumenFacturas" class="status-msg mt-12">
            <!-- JS -->
          </div>
        </div>
      </section>

      <!-- ========== CLIENTES ========== -->
      <section id="clientesView" class="screen">
        <div class="card">
          <div class="card-header-row">
            <div>
              <h2 class="card-title">Clientes</h2>
              <p class="card-subtitle">Directorio de clientes del taller.</p>
            </div>
            <div class="card-actions">
              <input
                type="text"
                id="buscarClienteInput"
                class="small-input"
                placeholder="Buscar por nombre, teléfono o dirección"
              />
              <button id="buscarClienteBtn" class="btn ghost">Buscar</button>
              <button id="nuevoClienteBtn" class="btn primary">Nuevo cliente</button>
            </div>
          </div>

          <div id="clientesTabla" class="table-wrapper">
            <!-- JS -->
          </div>
        </div>
      </section>

      <!-- ========== SUPLIDORES ========== -->
      <section id="suplidoresView" class="screen">
        <div class="card">
          <div class="card-header-row">
            <div>
              <h2 class="card-title">Suplidores</h2>
              <p class="card-subtitle">Lista de suplidores de piezas, pintura y servicios.</p>
            </div>
            <div class="card-actions">
              <input
                type="text"
                id="buscarSuplidorInput"
                class="small-input"
                placeholder="Buscar suplidor"
              />
              <button id="buscarSuplidorBtn" class="btn ghost">Buscar</button>
              <button id="nuevoSuplidorBtn" class="btn primary">Nuevo suplidor</button>
            </div>
          </div>

          <div id="suplidoresTabla" class="table-wrapper">
            <!-- JS -->
          </div>
        </div>
      </section>

      <!-- ========== CONFIGURACIÓN ========== -->
      <section id="configView" class="screen">
        <div class="grid-2">
          <!-- DATOS DEL TALLER -->
          <div class="card">
            <h2 class="card-title">Datos del taller</h2>
            <p class="card-subtitle">
              Logo, información de contacto y ajustes generales.
            </p>

            <form id="configForm" class="form-grid">
              <div class="form-group full">
                <label>Nombre del taller</label>
                <input type="text" name="tallerNombre" />
              </div>
              <div class="form-group">
                <label>Teléfono</label>
                <input type="text" name="tallerTelefono" />
              </div>
              <div class="form-group">
                <label>Correo electrónico</label>
                <input type="email" name="tallerEmail" />
              </div>
              <div class="form-group full">
                <label>Dirección física</label>
                <input type="text" name="tallerDireccion" />
              </div>
              <div class="form-group full">
                <label>URL del logo</label>
                <input type="text" name="logoUrl" />
              </div>
              <div class="form-group full">
                <label>Carpeta de fotos (Google Drive)</label>
                <input type="text" name="driveUrl" />
              </div>
              <div class="form-group">
                <label>Nuevo PIN de acceso</label>
                <input type="password" name="pinNuevo" />
              </div>

              <div class="form-actions full">
                <button type="submit" class="btn primary">Guardar configuración</button>
                <span id="configStatus" class="status-msg"></span>
              </div>
            </form>
          </div>

          <!-- LISTA DE PRECIOS -->
          <div class="card">
            <div class="card-header-row">
              <div>
                <h2 class="card-title">Lista de precios</h2>
                <p class="card-subtitle">
                  Plantilla de servicios para mecánica, hojalatería, pintura y detailing.
                </p>
              </div>
              <div class="card-actions">
                <button id="nuevoPrecioBtn" class="btn primary">Añadir servicio</button>
              </div>
            </div>

            <div id="preciosTabla" class="table-wrapper">
              <!-- JS -->
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- ========== MODAL GLOBAL ========== -->
  <div id="dialogBackdrop" class="dialog-backdrop hidden">
    <div class="dialog-card">
      <h3 id="dialogTitle">TÍTULO</h3>

      <form id="dialogForm">
        <div id="dialogFields"></div>

        <div class="dialog-actions">
          <button type="button" id="dialogCancelBtn" class="btn ghost">
            Cancelar
          </button>
          <button type="submit" id="dialogSubmitBtn" class="btn primary">
            Guardar
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- ========== SCRIPTS ========== -->
  <!-- Firebase v8 -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

  <!-- jsPDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <!-- App -->
  <script src="app.js?v=1"></script>
</body>
</html>
