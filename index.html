<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Nexus Auto Pro 2026</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" type="image/png" href="assets/logo-auto.png" />
  <link rel="stylesheet" href="styles.css?v=1" />

  <!-- Firebase v8 -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

  <!-- jsPDF para cotizaciones/facturas PDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>

  <!-- ========== LOGIN: PIN + GOOGLE ========== -->
  <div id="loginView" class="view visible">
    <div class="login-card">
      <div class="login-logo">
        <img src="assets/logo-auto.png" alt="Nexus Auto Pro" />
        <h1>Nexus Auto Pro 2026</h1>
        <p>Gestión profesional de talleres automotrices</p>
      </div>

      <form id="pinForm" class="pin-form">
        <label for="pinInput">PIN de acceso</label>
        <input id="pinInput" type="password" maxlength="6" autocomplete="off" placeholder="••••" required />
        <button type="submit" class="btn primary">Entrar con PIN</button>
        <p class="pin-hint">PIN inicial por defecto: <strong>0000</strong> (cámbialo en Configuración)</p>
      </form>

      <div class="auth-divider">
        <span></span><p>o</p><span></span>
      </div>

      <button id="googleSignInBtn" class="btn outline">
        Entrar con Google (taller)
      </button>

      <p class="login-footer">
        Multiusuario · Datos en la nube · Versión móvil y escritorio
      </p>
    </div>
  </div>

  <!-- ========== APP PRINCIPAL ========== -->
  <div id="appView" class="view">
    <!-- HEADER / MENÚ -->
    <header class="app-header">
      <div class="brand">
        <img src="assets/logo-auto.png" alt="Nexus Auto Pro" class="brand-logo" />
        <div class="brand-text">
          <h2>Nexus Auto Pro 2026</h2>
          <p>Taller automotriz · Puerto Rico</p>
        </div>
      </div>

      <nav class="main-menu">
        <button class="menu-btn active" data-view="ingresosView">Ingresos</button>
        <button class="menu-btn" data-view="entregasView">Entregas</button>
        <button class="menu-btn" data-view="historialView">Historial</button>
        <button class="menu-btn" data-view="cotizacionesView">Cotizaciones</button>
        <button class="menu-btn" data-view="facturasView">Facturas</button>
        <button class="menu-btn" data-view="clientesView">Clientes</button>
        <button class="menu-btn" data-view="suplidoresView">Suplidores</button>
        <button class="menu-btn" data-view="configView">Configuración</button>
        <button class="menu-btn danger" id="logoutBtn">Salir</button>
      </nav>
    </header>

    <!-- CONTENIDO -->
    <main class="app-main">
      <!-- ========== INGRESOS (registro entrada vehículos) ========== -->
      <section id="ingresosView" class="screen visible">
        <h1>Ingreso de vehículo</h1>
        <p class="section-subtitle">Registrar entrada para mecánica, hojalatería, pintura o detailing.</p>

        <form id="ingresoForm" class="grid-form">
          <div class="field">
            <label>Nombre del cliente</label>
            <input name="clienteNombre" required />
          </div>
          <div class="field">
            <label>Teléfono</label>
            <input name="clienteTelefono" type="tel" required />
          </div>
          <div class="field">
            <label>Dirección</label>
            <input name="clienteDireccion" />
          </div>
          <div class="field">
            <label>Tablilla</label>
            <input name="vehiculoTablilla" required />
          </div>
          <div class="field">
            <label>Marca</label>
            <input name="vehiculoMarca" required />
          </div>
          <div class="field">
            <label>Modelo</label>
            <input name="vehiculoModelo" required />
          </div>
          <div class="field">
            <label>Año</label>
            <input name="vehiculoAno" type="number" min="1900" max="2100" />
          </div>
          <div class="field">
            <label>Color</label>
            <input name="vehiculoColor" />
          </div>
          <div class="field full">
            <label>VIN Number</label>
            <input name="vehiculoVin" />
          </div>
          <div class="field">
            <label>Tipo de trabajo</label>
            <select name="tipoTrabajo" required>
              <option value="mecanica">Mecánica</option>
              <option value="hojalateria">Hojalatería y carrocería</option>
              <option value="pintura">Pintura</option>
              <option value="detailing">Detailing</option>
              <option value="otro">Otro</option>
            </select>
          </div>
          <div class="field full">
            <label>Trabajo sugerido / diagnóstico</label>
            <textarea name="descripcionTrabajo" rows="3"
              placeholder="Ej. Ruido en tren delantero, verificar frenos, golpe en guardalodo derecho, etc."></textarea>
          </div>

          <div class="form-actions">
            <button type="submit" class="btn primary">Guardar ingreso</button>
            <span id="ingresoStatus" class="status-msg"></span>
          </div>
        </form>

        <h2 class="mt-32">Ingresos abiertos</h2>
        <div id="ingresosLista" class="table-wrap small">
          <!-- JS llenará esta tabla -->
        </div>
      </section>

      <!-- ========== ENTREGAS ========== -->
      <section id="entregasView" class="screen">
        <h1>Entregas de vehículos</h1>
        <p class="section-subtitle">Cerrar trabajos, registrar pagos y observaciones de entrega.</p>
        <p class="placeholder">
          Las entregas se manejan desde el listado de ingresos abiertos (botón "Registrar entrega" en cada fila).
        </p>
      </section>

      <!-- ========== HISTORIAL ========== -->
      <section id="historialView" class="screen">
        <h1>Historial por cliente</h1>
        <p class="section-subtitle">
          Buscar historial de ingresos, reparaciones y facturas por nombre, tablilla o VIN.
        </p>

        <div class="toolbar">
          <input id="historialBuscarInput" placeholder="Nombre, tablilla o VIN..." />
          <button id="historialBuscarBtn" class="btn small">Buscar</button>
        </div>

        <div id="historialResultados" class="table-wrap">
          <!-- JS: resultados de historial -->
        </div>
      </section>

      <!-- ========== COTIZACIONES ========== -->
      <section id="cotizacionesView" class="screen">
        <div class="screen-header">
          <div>
            <h1>Cotizaciones</h1>
            <p class="section-subtitle">Cotizaciones para clientes y seguros de autos (formato Puerto Rico).</p>
          </div>
          <button id="nuevaCotizacionBtn" class="btn primary">Nueva cotización</button>
        </div>

        <div class="toolbar">
          <button id="exportCotizacionesBtn" class="btn small">Imprimir listado (PDF)</button>
        </div>

        <div id="cotizacionesTabla" class="table-wrap">
          <!-- JS: tabla de cotizaciones -->
        </div>
      </section>

      <!-- ========== FACTURAS ========== -->
      <section id="facturasView" class="screen">
        <div class="screen-header">
          <div>
            <h1>Facturas</h1>
            <p class="section-subtitle">Facturas automotrices · pagadas, pendientes, historial completo.</p>
          </div>
          <button id="nuevaFacturaBtn" class="btn primary" disabled title="Se generan desde Entregas">
            Nueva factura
          </button>
        </div>

        <div id="resumenFacturas" class="toolbar">
          <!-- JS: resumen Pagadas / Pendientes / Total cobrado -->
        </div>

        <div class="toolbar">
          <select id="filtroEstadoFactura" class="small-select">
            <option value="todas">Todas</option>
            <option value="pendiente">Pendientes de pago</option>
            <option value="pagada">Pagadas</option>
          </select>
          <button id="exportFacturasBtn" class="btn small">Imprimir listado (PDF)</button>
        </div>

        <div id="facturasTabla" class="table-wrap">
          <!-- JS: tabla de facturas -->
        </div>
      </section>

      <!-- ========== CLIENTES ========== -->
      <section id="clientesView" class="screen">
        <div class="screen-header">
          <div>
            <h1>Clientes</h1>
            <p class="section-subtitle">Listado de clientes del taller.</p>
          </div>
          <button id="nuevoClienteBtn" class="btn primary">Nuevo cliente</button>
        </div>

        <div class="toolbar">
          <input id="buscarClienteInput" placeholder="Buscar cliente..." />
          <button id="buscarClienteBtn" class="btn small">Buscar</button>
        </div>

        <div id="clientesTabla" class="table-wrap">
          <!-- JS: tabla de clientes -->
        </div>
      </section>

      <!-- ========== SUPLIDORES ========== -->
      <section id="suplidoresView" class="screen">
        <div class="screen-header">
          <div>
            <h1>Suplidores</h1>
            <p class="section-subtitle">Listado de suplidores de piezas, pintura, detailing, etc.</p>
          </div>
          <button id="nuevoSuplidorBtn" class="btn primary">Nuevo suplidor</button>
        </div>

        <div class="toolbar">
          <input id="buscarSuplidorInput" placeholder="Buscar suplidor..." />
          <button id="buscarSuplidorBtn" class="btn small">Buscar</button>
        </div>

        <div id="suplidoresTabla" class="table-wrap">
          <!-- JS: tabla de suplidores -->
        </div>
      </section>

      <!-- ========== CONFIGURACIÓN ========== -->
      <section id="configView" class="screen">
        <h1>Configuración del taller</h1>
        <p class="section-subtitle">Personaliza logo, colores, datos del taller, PIN de acceso y reglas básicas.</p>

        <form id="configForm" class="grid-form">
          <div class="field full">
            <label>Nombre del taller</label>
            <input name="tallerNombre" placeholder="Ej. Auto Clinic PR, Taller XYZ" />
          </div>
          <div class="field">
            <label>Teléfono principal</label>
            <input name="tallerTelefono" />
          </div>
          <div class="field">
            <label>Correo electrónico</label>
            <input name="tallerEmail" type="email" />
          </div>
          <div class="field full">
            <label>Dirección física</label>
            <input name="tallerDireccion" />
          </div>

          <div class="field">
            <label>Logo del taller (URL)</label>
            <input name="logoUrl" placeholder="https://..." />
          </div>
          <div class="field">
            <label>PIN de acceso nuevo</label>
            <input name="pinNuevo" type="password" maxlength="6" placeholder="••••" />
          </div>

          <div class="field full">
            <label>Enlace carpeta de fotos en Google Drive (antes/después)</label>
            <input name="driveUrl" placeholder="https://drive.google.com/..." />
          </div>

          <div class="form-actions">
            <button type="submit" class="btn primary">Guardar configuración</button>
            <span id="configStatus" class="status-msg"></span>
          </div>
        </form>

        <h2 class="mt-32">Listas de precios (por servicio / categoría)</h2>
        <p class="section-subtitle">
          Lista base de precios para mecánica, hojalatería, pintura y detailing. Se usarán en cotizaciones y facturas.
        </p>

        <div class="toolbar">
          <button id="nuevoPrecioBtn" class="btn small">Añadir servicio</button>
        </div>

        <div id="preciosTabla" class="table-wrap">
          <!-- JS: lista de precios -->
        </div>
      </section>
    </main>
  </div>

  <script src="app.js?v=1"></script>
</body>
</html>
